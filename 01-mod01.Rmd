# Key concepts related to Chemical Reactors Design {#intro}

In a homogeneous system, the rate of a chemical reaction can be easily estimated because it depends on the temperature system and the concentrations of both reactants and products. However, the prediction on heterogeneous systems is more complicated because of the effect of mass and heat transfer rate over the reaction rate.

## Fundamental of Kinetics and Reaction Equilibrium

It is essential to review some definitions related to design a chemical reactor before starting with our main subject. The first one is **reaction rate**. For a homogeneous reaction, the reaction rate is defined either as the amount of product formed or the amount of reactant consumed per unit volume of the liquid or gas phase per unit time.

\begin{equation*}
  r \equiv \frac{\text{moles consumed or produced}}{\text{reactor volume} \times \text{time}}
\end{equation*}

The reaction rate is based on moles of reactant consumed or produced per unit mass of catalyst per unit time for solid-catalyzed reactions.

\begin{equation*}
    r \equiv \frac{\text{moles consumed or produced}}{\text{mass of catalyst} \times \text{time}}
\end{equation*}

The second important is **conversion**, $X$, which is defined as the fraction of the more critical or limiting reactant consumed. 

\begin{equation*}
X_A \equiv \frac{\text{moles A reacted}}{\text{moles of A fed}}
\end{equation*}

The **yield** is the quantity created by the desired product compared to the quantity that would have been generated if there were no by-products and the primary reaction was completed.

\begin{equation*}
Y \equiv \frac{\text{moles of product formed}}{\text{maximum moles of product},\,X=1.0}
\end{equation*}

For $nA \rightarrow B$

\begin{equation*}
Y \equiv \frac{F_B}{F_A/n}
\end{equation*}

Finally, the **selectivity** is the amount of desired product divided by the amount of reactant consumed. This ratio often changes as the reaction progresses, and the selectivity based on the final mixture composition should be called an _average selectivity_.

For $nA \rightarrow B$
\begin{equation*}
\overline{S} = \frac{\text{B formed}}{\text{A used}} = \frac{F_B}{F_A\,X_A/n} = \frac{Y}{X_A}
\end{equation*}

### Power-Law Kinetics

#### Irreversible Reaction
For an irreversible reaction where two reactants forming a product
\begin{equation*}
A + B \rightarrow C
\end{equation*}

- The overall reaction rate $r$ can be expressed as the moles of components A being consumed per unit time per unit volume.
- Additionally, the overall reaction rate has a temperature dependence governed by the specific reaction rate $k(T)$ and a concentration dependence.

In terms of molar concentrations for components $A$ and $B$, the overall rate reaction could be expressed as:

\begin{equation*}
    r = k(T)\,C_A^\alpha\,C_B^\beta
\end{equation*}
where $\alpha$ and $\beta$ are the order of reaction for each reactants.

The actual reaction mechanism determines the form of the kinetic expression. 

- More than one mechanism may provide the same expression of the rate. 
- Only in elementary reaction steps the reaction order equal to the stoichiometry.

The temperature-dependent specific reaction $k(T)$ is represented by Arrhenius equation
\begin{equation*}
  k(T) = k_0(T) \exp\left[{\left(-E/R/T\right)}\right]
\end{equation*}
where $k_0(T)$ is the pre-exponential factor, usually a big positive number that has units with respect to each component based on the concentration units and the order of the reaction, $E$ is the activation energy, $R$ is the universal gas-constant, and $T$ is the absolute temperature.

If $n = \alpha + \beta$ then
\begin{equation*}
  k(T) = \frac{\left[\text{Concentration}^{\left(1-n\right)}\right]}{\text{time}}
\end{equation*}

It is essential to know that:

1. If temperature increase the $k_0(T)$ will be increased.
2. $k_0(T)$ will be more sensitive to temperature changes at higher activation energy.

#### Reversible Reaction

Consider next reversible reaction

<center>
![](figures/eq1.png){width=30%}
</center>

The forward rate reaction in terms of molar concentrations of reactants A and B will be: 
\begin{gather*}
    r_f = k_f(T)\,C_A^\alpha\,C_B^\beta \\
    k_f(T) = k_{0_f}(T) \exp{\left(-E_f/R/T\right)}
\end{gather*}

The reverse rate reaction will be: 
\begin{gather*}
    r_r = k_r(T)\,C_C^\gamma\\
    k_r(T) = k_{0_r}(T) \exp{\left(-E_R/R/T\right)}
\end{gather*}

The net overall rate reaction will be: 
\begin{equation*}
  r = r_F - r_R = k_F(T)\,C_A^\alpha\,C_B^\beta - k_R(T)\,C_C^\gamma
\end{equation*}

Under chemical equilibrium conditions, the net overall rate reaction is equal to zero, which leads to: 
\begin{gather*}
  K_\text{eq} = \frac{k_f(T)}{k_r(T)} = \frac{C_A^\alpha\,C_B^\beta}{C_C^\gamma} \\
   K_\text{eq} = \frac{k_{0_r}(T) \exp{\left(-E_r/R/T\right)}}{k_{0_r}(T) \exp{\left(-E_r/R/T\right)}} = \frac{k_{0_f}}{k_{0_r}}\,\exp\left(\frac{E_r-E_f}{RT}\right)
\end{gather*}


It is important to know that:

- If $E_R = E_F$, then $K_\text{eq}$ is independent of temperature

- If $E_R > E_F$, then the process is exothermic, so if temperature increases, then the exponential factor decreases and $K_\text{eq}$ decreases.

- If $E_R < E_F$, then the process is endothermic (energy is required in order to transform reactants into products), so if temperature increases, then the exponential factor increases, and $K_\text{eq}$ increases.

The van't Hoff equation of thermodynamics gives the temperature dependence of the chemical equilibrium constant.
\begin{gather*}
  \frac{d\,\ln K_\text{eq}}{d\,T} = \frac{\Delta H_R^\circ (T)}{R\,T^2} \\
  \Delta H_R^\circ(T) = E_f - E_r
\end{gather*}

### Multiple Reactions
In a reacting system might occur more than one chemical reaction. 
We are frequently interested in just one called the principal, while others are side-reactions. The latter produce undesired components that diminish the yield of the desired product.

#### Parallel Reactions

In this case, the reactants form other undesired products in parallel with the primary reaction. For example:

<center>
![](figures/eq2.png){width=15%}
</center>

If we assume first-order kinetics, the reactions occur in a simple batch isothermal reactor at volume constant. The concentrations of each component could be express as:

\begin{align*}
  \frac{d\,C_A}{dt} &= -\left(k_B+k_C\right)\,C_A \\
  \frac{d\,C_B}{dt} &= k_B\,C_A \\
  \frac{d\,C_C}{dt} &= k_C\,C_A
\end{align*}

If at $t=0$, $C_A = C_{A0}$, $C_B=0$ and $C_C = 0$ then
\begin{align*}
  \frac{C_A}{C_{A0}} &= e^{-\left(k_B+k_C\right)\,t} \\
  \frac{C_B}{C_{A0}} &= \frac{k_B}{k_B+k_C}\,\left(1-e^{-\left(k_B+k_C\right)\,t} \right)\\
  \frac{C_C}{C_{A0}} &= \frac{k_C}{k_B+k_C}\,\left(1-e^{-\left(k_B+k_C\right)\,t} \right)
\end{align*}

From **scypi.integrate**, we can use the function **solve_ivp** to solve ODEs using several Runge-Kutta's methods.

```
solution = solve_ivp(fun, (0, tfin), c0, 
                    t_eval=np.linspace(0, tfin, 100))
```

The graphical solution for this sample is available ([file](https://github.com/aliglara/ebook_che5314_ucv/blob/main/codes/lect_001BatchReactorParallel.ipynb)). 

```{r sollect01, out.width = "70%", echo=FALSE, fig.align='center', fig.cap='Concentrations vs time for parallel reactions. Left, k1 = 2, Right: k1 = 4', fig.lp='fig:'}
library(png)
library(grid)
img <- readPNG("figures/sollect01.png")
grid.raster(img)
```

In figure \@ref(fig:sollect01), we could see that more product B is generated at higher $k_B$ values concerning $k_C$. This behavior is represented in terms of the **Selectivity (S)** to the desired product:

\begin{equation*}
  S =\frac{C_B}{C_C}
\end{equation*}	

Our job as engineers is to optimize the reactor's operation, so in this case, we must find the best operating temperature to maximize selectivity. In the case the reactor has more than one reactant, the selectivity is affected by their concentrations. 




